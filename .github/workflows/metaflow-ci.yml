name: Deploy RandomQuoteFlow

on:
  push:
    paths:
      - 'random_quote_flow.py'   # Workflow सिर्फ तब trigger होगा जब यह file बदलेगी

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'

      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install metaflow requests kubernetes outerbounds

      - name: Configure Outerbounds CLI
        env:
          OUTERBOUNDS_TOKEN: ${{ secrets.OUTERBOUNDS_TOKEN }}
        run: |
          outerbounds configure $OUTERBOUNDS_TOKEN

      - name: Deploy RandomQuoteFlow to Outerbounds
        env:
          METAFLOW_PROFILE: ${{ secrets.METAFLOW_PROFILE }}
        run: |
          echo "Deploying RandomQuoteFlow..."
          python random_quote_flow.py argo-workflows create
